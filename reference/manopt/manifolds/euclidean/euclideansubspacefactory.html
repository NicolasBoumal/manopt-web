<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of euclideansubspacefactory</title>
  <meta name="keywords" content="euclideansubspacefactory">
  <meta name="description" content="Returns a manifold struct to optimize over a subspace of a linear manifold">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">manopt</a> &gt; <a href="#">manifolds</a> &gt; <a href="index.html">euclidean</a> &gt; euclideansubspacefactory.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for manopt\manifolds\euclidean&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>euclideansubspacefactory
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Returns a manifold struct to optimize over a subspace of a linear manifold</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function M = euclideansubspacefactory(E, proj, dim) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Returns a manifold struct to optimize over a subspace of a linear manifold

 The factory produces a manifold description M for a linear subspace S of
 a linear space E.

 Points and tangent vectors on M are represented in memory in exactly the
 same way as they are for E. Furthermore, E is considered the embedding
 space of S. In particular, the Euclidean gradient of a function is
 understood as the gradient of that function in E, whereas the gradient of
 that function in S is here called the Riemannian gradient. Similar
 considerations hold for the Hessian.

 The linear space E is described by a structure obtained from a factory.
 For example, E can be the space of vectors, matrices or nD-arrays of real
 or complex numbers, or a subspace of those. E is equipped with a (real)
 inner product, making it a (real) Euclidean space.

 The subspace S is described by an orthogonal projector proj from E to E,
 whose image (i.e., span, range, ...) is S. Orthogonality is judged with
 respect to the inner product on E, and S inherits that inner product,
 making it a Euclidean space itself, and a Riemannian submanifold of E.

 The dimension of the subspace S must ideally also be specified.

 Inputs:
   E is the factory for a linear space; for example:
       E = euclideanfactory(n)
       E = euclideanfactory(n, m)
       E = euclideanfactory([n1, n2, n3])
       E = euclideancomplexfactory(n) % and other dimensions too
       ...

   proj is a function handle that takes as input a point u of E and
       returns another point of E: the orthogonal projection of u to S.
       Orthogonality is understood with respect to the inner product on E,
       that is, E.inner(x, u, v) = &lt;u, v&gt;. Like any orthogonal projector,
       it must be linear, and it must satisfy:
           &lt;u, Pv&gt; = &lt;Pu, v&gt;    and    PPw = Pw
       for all points u, v, w in E.
       To check these properties on random vectors, call M.checkproj();

   dim is the dimension of the subspace S (an integer). As always in
       Manopt, we consider linear spaces over the real numbers, hence,
       this is the dimension of S as a real linear space. For example, the
       dimension of R^n is n, and the dimension of C^n is 2n.

 Output:
   M is a factory for optimization over the subspace S.


 Example:

 Among complex vector of length n, consider the subspace S of such vectors
 that can be the discrete Fourier transform of a real vector of length n
 (that is, the subspace generated by feeding all real vectors of length n
 to fft). The factory M below describes that subspace.

   n = 17;
   E = euclideancomplexfactory(n);
   proj = @(u) (u + conj(u([1 ; (n:-1:2)'])))/2;
   M = euclideansubspacefactory(E, proj, n);
   M.checkproj(); % for debugging


 Note 1: this factory is designed to work with linear subspaces only: it
 does not work for affine subspaces. Explicitly: S must contain the origin
 of E. If you need support for affine subspaces, let us know on the Manopt
 forum and we can help (or share your improved code :)).

 Note 2: the linear space E can itself be a linear subspace of another.
 For example, we can have:
       E = symmetricfactory(n, k)
       E = skewfactory(n, k)
       E = euclideansubspacefactory(...) % recursive nesting
 For these use-cases, bear in mind that the embedding space of M is E,
 hence, the Euclidean gradient and Hessian are expected to be given in E,
 not in the 'bigger' linear space E possibly lives in.

 See also: <a href="euclideanfactory.html" class="code" title="function M = euclideanfactory(m, n)">euclideanfactory</a> <a href="euclideancomplexfactory.html" class="code" title="function M = euclideancomplexfactory(m, n)">euclideancomplexfactory</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function v = randvec(x)</a></li><li><a href="#_sub2" class="code">function checkproj(E, proj)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function M = euclideansubspacefactory(E, proj, dim)</a>
0002 <span class="comment">% Returns a manifold struct to optimize over a subspace of a linear manifold</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% The factory produces a manifold description M for a linear subspace S of</span>
0005 <span class="comment">% a linear space E.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% Points and tangent vectors on M are represented in memory in exactly the</span>
0008 <span class="comment">% same way as they are for E. Furthermore, E is considered the embedding</span>
0009 <span class="comment">% space of S. In particular, the Euclidean gradient of a function is</span>
0010 <span class="comment">% understood as the gradient of that function in E, whereas the gradient of</span>
0011 <span class="comment">% that function in S is here called the Riemannian gradient. Similar</span>
0012 <span class="comment">% considerations hold for the Hessian.</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% The linear space E is described by a structure obtained from a factory.</span>
0015 <span class="comment">% For example, E can be the space of vectors, matrices or nD-arrays of real</span>
0016 <span class="comment">% or complex numbers, or a subspace of those. E is equipped with a (real)</span>
0017 <span class="comment">% inner product, making it a (real) Euclidean space.</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% The subspace S is described by an orthogonal projector proj from E to E,</span>
0020 <span class="comment">% whose image (i.e., span, range, ...) is S. Orthogonality is judged with</span>
0021 <span class="comment">% respect to the inner product on E, and S inherits that inner product,</span>
0022 <span class="comment">% making it a Euclidean space itself, and a Riemannian submanifold of E.</span>
0023 <span class="comment">%</span>
0024 <span class="comment">% The dimension of the subspace S must ideally also be specified.</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Inputs:</span>
0027 <span class="comment">%   E is the factory for a linear space; for example:</span>
0028 <span class="comment">%       E = euclideanfactory(n)</span>
0029 <span class="comment">%       E = euclideanfactory(n, m)</span>
0030 <span class="comment">%       E = euclideanfactory([n1, n2, n3])</span>
0031 <span class="comment">%       E = euclideancomplexfactory(n) % and other dimensions too</span>
0032 <span class="comment">%       ...</span>
0033 <span class="comment">%</span>
0034 <span class="comment">%   proj is a function handle that takes as input a point u of E and</span>
0035 <span class="comment">%       returns another point of E: the orthogonal projection of u to S.</span>
0036 <span class="comment">%       Orthogonality is understood with respect to the inner product on E,</span>
0037 <span class="comment">%       that is, E.inner(x, u, v) = &lt;u, v&gt;. Like any orthogonal projector,</span>
0038 <span class="comment">%       it must be linear, and it must satisfy:</span>
0039 <span class="comment">%           &lt;u, Pv&gt; = &lt;Pu, v&gt;    and    PPw = Pw</span>
0040 <span class="comment">%       for all points u, v, w in E.</span>
0041 <span class="comment">%       To check these properties on random vectors, call M.checkproj();</span>
0042 <span class="comment">%</span>
0043 <span class="comment">%   dim is the dimension of the subspace S (an integer). As always in</span>
0044 <span class="comment">%       Manopt, we consider linear spaces over the real numbers, hence,</span>
0045 <span class="comment">%       this is the dimension of S as a real linear space. For example, the</span>
0046 <span class="comment">%       dimension of R^n is n, and the dimension of C^n is 2n.</span>
0047 <span class="comment">%</span>
0048 <span class="comment">% Output:</span>
0049 <span class="comment">%   M is a factory for optimization over the subspace S.</span>
0050 <span class="comment">%</span>
0051 <span class="comment">%</span>
0052 <span class="comment">% Example:</span>
0053 <span class="comment">%</span>
0054 <span class="comment">% Among complex vector of length n, consider the subspace S of such vectors</span>
0055 <span class="comment">% that can be the discrete Fourier transform of a real vector of length n</span>
0056 <span class="comment">% (that is, the subspace generated by feeding all real vectors of length n</span>
0057 <span class="comment">% to fft). The factory M below describes that subspace.</span>
0058 <span class="comment">%</span>
0059 <span class="comment">%   n = 17;</span>
0060 <span class="comment">%   E = euclideancomplexfactory(n);</span>
0061 <span class="comment">%   proj = @(u) (u + conj(u([1 ; (n:-1:2)'])))/2;</span>
0062 <span class="comment">%   M = euclideansubspacefactory(E, proj, n);</span>
0063 <span class="comment">%   M.checkproj(); % for debugging</span>
0064 <span class="comment">%</span>
0065 <span class="comment">%</span>
0066 <span class="comment">% Note 1: this factory is designed to work with linear subspaces only: it</span>
0067 <span class="comment">% does not work for affine subspaces. Explicitly: S must contain the origin</span>
0068 <span class="comment">% of E. If you need support for affine subspaces, let us know on the Manopt</span>
0069 <span class="comment">% forum and we can help (or share your improved code :)).</span>
0070 <span class="comment">%</span>
0071 <span class="comment">% Note 2: the linear space E can itself be a linear subspace of another.</span>
0072 <span class="comment">% For example, we can have:</span>
0073 <span class="comment">%       E = symmetricfactory(n, k)</span>
0074 <span class="comment">%       E = skewfactory(n, k)</span>
0075 <span class="comment">%       E = euclideansubspacefactory(...) % recursive nesting</span>
0076 <span class="comment">% For these use-cases, bear in mind that the embedding space of M is E,</span>
0077 <span class="comment">% hence, the Euclidean gradient and Hessian are expected to be given in E,</span>
0078 <span class="comment">% not in the 'bigger' linear space E possibly lives in.</span>
0079 <span class="comment">%</span>
0080 <span class="comment">% See also: euclideanfactory euclideancomplexfactory</span>
0081 
0082 <span class="comment">% This file is part of Manopt: www.manopt.org.</span>
0083 <span class="comment">% Original author: Nicolas Boumal, April 25, 2019.</span>
0084 <span class="comment">% Contributors:</span>
0085 <span class="comment">% Change log:</span>
0086 
0087     M = E;
0088     
0089     M.name = @() [<span class="string">'Subspace of '</span>, E.name()];
0090     
0091     M.proj = @(x, u) proj(u);
0092     
0093     M.egrad2rgrad = @(x, eg) proj(eg);
0094     
0095     M.ehess2rhess = @(x, eg, eh, d) proj(eh);
0096     
0097     M.tangent = @(x, u) proj(u);
0098     
0099     M.rand = @() proj(E.rand());
0100     
0101     M.randvec = @<a href="#_sub1" class="code" title="subfunction v = randvec(x)">randvec</a>;
0102     <a name="_sub1" href="#_subfunctions" class="code">function v = randvec(x)</a>
0103         v = proj(E.randvec(x));
0104         v = v / E.norm(x, v);
0105     <span class="keyword">end</span>
0106     
0107     <span class="keyword">if</span> exist(<span class="string">'dim'</span>, <span class="string">'var'</span>)
0108         M.dim = @() dim;
0109         M.typicaldist = @() sqrt(dim);
0110     <span class="keyword">else</span>
0111         M = rmfield(M, <span class="string">'dim'</span>);
0112         warning(<span class="string">'manopt:subspacedim'</span>, <span class="keyword">...</span>
0113                [<span class="string">'Since the dimension of the subspace was not specified'</span> <span class="keyword">...</span>
0114                 <span class="string">', M.dim() is not available in the returned factory.'</span>]);
0115     <span class="keyword">end</span>
0116     
0117     M.checkproj = @() <a href="#_sub2" class="code" title="subfunction checkproj(E, proj)">checkproj</a>(E, proj);
0118 
0119 <span class="keyword">end</span>
0120 
0121 <span class="comment">% Tool to check that proj is indeed an orthogonal projector to a subspace</span>
0122 <span class="comment">% of E, with respect to the inner product on the linear space E.</span>
0123 <a name="_sub2" href="#_subfunctions" class="code">function checkproj(E, proj)</a>
0124     x = E.rand();
0125     u = E.randvec(x);
0126     v = E.randvec(x);
0127     a = randn();
0128     b = randn();
0129     <span class="comment">% Check that P is linear.</span>
0130     Paubv = proj(E.lincomb(x, a, u, b, v));
0131     aPvbPv = E.lincomb(x, a, proj(u), b, proj(v));
0132     fprintf([<span class="string">'Is proj linear? This number should be zero up to '</span> <span class="keyword">...</span>
0133              <span class="string">'machine precision:\n\t%.16e\n'</span>], <span class="keyword">...</span>
0134                 E.norm(x, E.lincomb(x, 1, Paubv, -1, aPvbPv)));
0135     <span class="comment">% Check that PPw = Pw.</span>
0136     fprintf([<span class="string">'Is it a projector? This number should be zero up to '</span> <span class="keyword">...</span>
0137              <span class="string">'machine precision:\n\t%.16e\n'</span>], <span class="keyword">...</span>
0138                 E.norm(x, E.lincomb(x, 1, proj(u), -1, proj(proj(u)))));
0139     <span class="comment">% Check that &lt;u, Pv&gt; = &lt;Pu, v&gt;.</span>
0140     fprintf([<span class="string">'Is it self-adjoint? These two numbers should be equal '</span> <span class="keyword">...</span>
0141              <span class="string">'up to machine precision:\n\t%.16e\n\t%.16e\n'</span>], <span class="keyword">...</span>
0142                 E.inner(x, u, proj(v)), <span class="keyword">...</span>
0143                 E.inner(x, proj(u), v));
0144 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 30-Sep-2022 13:18:25 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>