<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of TTeMPS_op_laplace</title>
  <meta name="keywords" content="TTeMPS_op_laplace">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../../index.html">Home</a> &gt;  <a href="#">manopt</a> &gt; <a href="#">manifolds</a> &gt; <a href="../../index.html">ttfixedrank</a> &gt; <a href="../index.html">TTeMPS_1.1</a> &gt; <a href="index.html">@TTeMPS_op_laplace</a> &gt; TTeMPS_op_laplace.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../../index.html"><img alt="<" border="0" src="../../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for manopt\manifolds\ttfixedrank\TTeMPS_1.1\@TTeMPS_op_laplace&nbsp;<img alt=">" border="0" src="../../../../../right.png"></a></td></tr></table>-->

<h1>TTeMPS_op_laplace
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../../matlabicon.gif)">
<li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS/contract.html" class="code" title="function res = contract( x, y, idx )">contract</a>	CONTRACT Contraction of two TT/MPS tensors.</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS/disp.html" class="code" title="function disp( x, name )">disp</a>	DISP Display TT/MPS tensor.</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS/display.html" class="code" title="function display(x)">display</a>	DISP Display TT/MPS tensor as a tensor network</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS/full.html" class="code" title="function y = full( x )">full</a>	FULL Convert TTeMPS tensor to full array</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS/mtimes.html" class="code" title="function x = mtimes( a, x )">mtimes</a>	MINUS Multiplication of TT/MPS tensor by scalar.</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_block/disp.html" class="code" title="function disp( x, name )">disp</a>	DISP Display TT/MPS block-mu tensor.</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_block/display.html" class="code" title="function display(x)">display</a>	DISP Display TT/MPS tensor as a tensor network</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_block/full.html" class="code" title="function y = full( x )">full</a>	FULL Convert TTeMPS tensor to full array</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_block/mtimes.html" class="code" title="function x = mtimes( a, x )">mtimes</a>	MINUS Multiplication of TT/MPS block tensor by scalar or vector</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_op/apply.html" class="code" title="function y = apply( A, x, idx )">apply</a>	APPLY Application of TT/MPS operator to a TT/MPS tensor</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_op/contract.html" class="code" title="function res = contract( A, X, mu )">contract</a>	CONTRACT Contraction of two TT/MPS tensors with inner TT/MPS operator.</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_op/disp.html" class="code" title="function disp( x, name )">disp</a>	DISP Display TT/MPS operator.</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_op/display.html" class="code" title="function display(x)">display</a>	DISPLAY Display TT/MPS tensor as a tensor network</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_op/full.html" class="code" title="function Afull = full( A )">full</a>	FULL Convert TTeMPS_op operator to full array</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS_op/mtimes.html" class="code" title="function A = mtimes( B, A )">mtimes</a>	MINUS Multiplication of TT/MPS operator by scalar.</li><li><a href="TTeMPS_op_laplace.html" class="code" title="">TTeMPS_op_laplace</a>	</li><li><a href="TTeMPS_op_laplace_to_TT_matrix.html" class="code" title="function B = TTeMPS_op_laplace_to_TT_matrix( A )">TTeMPS_op_laplace_to_TT_matrix</a>	TTeMPS_to_TT Convert to TT Toolbox matrix format.</li><li><a href="TTeMPS_op_laplace_to_TTeMPS_op.html" class="code" title="function res = TTeMPS_op_laplace_to_TTeMPS_op( A )">TTeMPS_op_laplace_to_TTeMPS_op</a>	TTeMPS_op_laplace_to_TTeMPS Convert to TT_op_laplace to TTeMPS_op format.</li><li><a href="apply.html" class="code" title="function y = apply( A, x, idx )">apply</a>	APPLY Application of TT/MPS Laplace-like operator to a TT/MPS tensor</li><li><a href="constr_precond_inner.html" class="code" title="function expB = constr_precond_inner( A, X, mu )">constr_precond_inner</a>	TTeMPS Toolbox.</li><li><a href="contract.html" class="code" title="function res = contract( A, X, mu )">contract</a>	CONTRACT Contraction of two TT/MPS tensors with inner TT/MPS Laplace operator.</li><li><a href="disp.html" class="code" title="function disp( x, name )">disp</a>	DISP Display TT/MPS operator.</li><li><a href="display.html" class="code" title="function display(x)">display</a>	DISP Display TT/MPS tensor as a tensor network</li><li><a href="mtimes.html" class="code" title="function A = mtimes( B, A )">mtimes</a>	MINUS Multiplication of TT/MPS Laplace operator by scalar.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../../matlabicon.gif)">
<li><a href="TTeMPS_op_laplace.html" class="code" title="">TTeMPS_op_laplace</a>	</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/examples/linearsystem_compare.html" class="code" title="">linearsystem_compare</a>	Example code for the algorithms described in</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/operators/TTeMPS_op_NN.html" class="code" title="">TTeMPS_op_NN</a>	</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/operators/TTeMPS_op_NN_hermite.html" class="code" title="">TTeMPS_op_NN_hermite</a>	</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/operators/anisotropicdiffusion.html" class="code" title="">anisotropicdiffusion</a>	</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/operators/laplace.html" class="code" title="function L = laplace( I, n, d );">laplace</a>	LAPLACE Construct a simple d-dimensional Laplace operator and return TTeMPS_op_laplace object.</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/operators/newton_potential.html" class="code" title="">newton_potential</a>	</li><li><a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/operators/parameterdependent.html" class="code" title="">parameterdependent</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function A = set.U( A, U_);</a></li><li><a href="#_sub2" class="code">function A = update_properties( A );</a></li><li><a href="#_sub3" class="code">function A = TTeMPS_op_laplace(varargin)</a></li><li><a href="#_sub4" class="code">function A = initialize_precond( A )</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="TTeMPS_op_laplace.html" class="code" title="">TTeMPS_op_laplace</a>
0002 <span class="comment">% TTeMPS_op_laplace</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%   A MATLAB class for representing and manipulating</span>
0005 <span class="comment">%   Laplace-like operators in the TT/MPS operator format,</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   Laplace-like operators are of the form</span>
0008 <span class="comment">%         L \otimes I \otimes I \otimes I</span>
0009 <span class="comment">%       + I \otimes L \otimes I \otimes I</span>
0010 <span class="comment">%       + ...</span>
0011 <span class="comment">%       + I \otimes I \otimes I \otimes L</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   with e.g. L being the discrete 1D-Laplacian matrix.</span>
0014 
0015 <span class="comment">%   TTeMPS Toolbox.</span>
0016 <span class="comment">%   Michael Steinlechner, 2013-2016</span>
0017 <span class="comment">%   Questions and contact: michael.steinlechner@epfl.ch</span>
0018 <span class="comment">%   BSD 2-clause license, see LICENSE.txt</span>
0019 
0020 properties( SetAccess = public, GetAccess = public )
0021 
0022     L0
0023     U           <span class="comment">% core tensors as 4D doubles</span>
0024     rank
0025     order
0026     size_row
0027     size_col
0028     V_L
0029     E_L
0030 
0031 <span class="keyword">end</span>
0032 
0033 <span class="comment">% Set methods for Cores</span>
0034 methods
0035     
0036     <a name="_sub0" href="#_subfunctions" class="code">function A = set.U( A, U_);</a>
0037         
0038         A.U = U_;
0039         A = <a href="#_sub2" class="code" title="subfunction A = update_properties( A );">update_properties</a>( A );
0040 
0041     <span class="keyword">end</span>
0042 
0043 
0044     <a name="_sub1" href="#_subfunctions" class="code">function A = update_properties( A );</a>
0045 
0046         A.rank = [1,  2*ones(1, length(A.U)-1), 1];  <span class="comment">% the TT rank is always two for such Laplace-like tensors</span>
0047         size_col_ = cellfun( @(y) size(y,1), A.U);
0048         A.size_col = size_col_ ./ (A.rank(1:end-1).*A.rank(2:end));
0049         A.size_row = cellfun( @(y) size(y,2), A.U);
0050         A.order = length( A.size_row );
0051 
0052     <span class="keyword">end</span>
0053 
0054 <span class="keyword">end</span>
0055 
0056 methods( Access = public )
0057 
0058     <a name="_sub2" href="#_subfunctions" class="code">function A = TTeMPS_op_laplace(varargin)</a>
0059     <span class="comment">%LAPLACE Construct a tensor in TT/MPS format and return TTeMPS_op_laplace object.</span>
0060     <span class="comment">%</span>
0061     <span class="comment">%   A = TTEMPS_OP_LAPLACE( L, D ) creates the D-dimensional Laplace-like</span>
0062     <span class="comment">%       TT/MPS operator using the supplied matrix L.</span>
0063     <span class="comment">%</span>
0064     <span class="comment">%</span>
0065         <span class="keyword">if</span> nargin == 1
0066             <span class="comment">% debug constructor</span>
0067             A.U = varargin{1};
0068             A = <a href="#_sub2" class="code" title="subfunction A = update_properties( A );">update_properties</a>( A );
0069             A.L0 = [];
0070             A.V_L = [];
0071             A.E_L = [];
0072         <span class="comment">% Default constructor</span>
0073         <span class="keyword">elseif</span> (nargin == 2)
0074 
0075             <span class="comment">% only one matrix passed</span>
0076             L = varargin{1};
0077             A.L0 = L;
0078             d = varargin{2};
0079 
0080             A.V_L = [];
0081             A.E_L = [];
0082             
0083             [m,n] = size( L );
0084             E = speye( m, n );
0085             a_1 = sparse( 1, 1, 1, 2, 1 );
0086             a_mid = sparse( 2, 1, 1, 4, 1 );
0087             a_end = sparse( 2, 1, 1, 2, 1 );
0088             b_1 = sparse( 2, 1, 1, 2, 1 );
0089             b_mid = sparse( [1;4], [1;1], [1;1], 4, 1 );
0090             b_end = sparse( 1, 1, 1, 2, 1 );
0091 
0092             A.U = cell( 1, d );
0093             A.U{1} = kron( L, a_1 ) + kron( E, b_1 );
0094             A_mid = kron( L, a_mid ) + kron( E, b_mid );
0095             <span class="keyword">for</span> i=2:d-1
0096                 A.U{i} = A_mid;
0097             <span class="keyword">end</span>
0098             A.U{d} = kron( L, a_end ) + kron( E, b_end );
0099 
0100             A = <a href="#_sub2" class="code" title="subfunction A = update_properties( A );">update_properties</a>( A );
0101 
0102         <span class="keyword">else</span>
0103             error(<span class="string">'Invalid number of arguments.'</span>)
0104         <span class="keyword">end</span>
0105     <span class="keyword">end</span>
0106     
0107     
0108     <span class="comment">% Other public functions</span>
0109     y = <a href="apply.html" class="code" title="function y = apply( A, x, idx )">apply</a>( A, x, idx );
0110     A = <a href="mtimes.html" class="code" title="function A = mtimes( B, A )">mtimes</a>( B, A );
0111     res = <a href="contract.html" class="code" title="function res = contract( A, X, mu )">contract</a>( A, x, y, idx );
0112     
0113     <a href="disp.html" class="code" title="function disp( x, name )">disp</a>( A, name );
0114     <a href="display.html" class="code" title="function display(x)">display</a>( A );
0115 
0116     B = <a href="TTeMPS_op_laplace_to_TTeMPS_op.html" class="code" title="function res = TTeMPS_op_laplace_to_TTeMPS_op( A )">TTeMPS_op_laplace_to_TTeMPS_op</a>( A );
0117     B = <a href="TTeMPS_op_laplace_to_TT_matrix.html" class="code" title="function B = TTeMPS_op_laplace_to_TT_matrix( A )">TTeMPS_op_laplace_to_TT_matrix</a>( A );
0118     expB = <a href="constr_precond_inner.html" class="code" title="function expB = constr_precond_inner( A, X, mu )">constr_precond_inner</a>( A, X, mu );
0119     
0120 
0121     <a name="_sub3" href="#_subfunctions" class="code">function A = initialize_precond( A )</a>
0122         [A.V_L, A.E_L] = eig(<a href="../../../../../manopt/manifolds/ttfixedrank/TTeMPS_1.1/@TTeMPS/full.html" class="code" title="function y = full( x )">full</a>(A.L0));
0123         A.E_L = diag( A.E_L );
0124     <span class="keyword">end</span>
0125 <span class="keyword">end</span>
0126 
0127 
0128 
0129 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 30-Sep-2022 13:18:25 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>