<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Manopt, symmetric stochastic multinomial manifold</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="favicon.ico" rel="icon" type="image/x-icon">
    <!-- Le styles -->
    <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
body {
        padding-top: 80px;
        padding-bottom: 40px;
}
      thead {
        font-weight: bold;
      }
    </style>
    <link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>    <![endif]-->
    <link href="bootstrap/css/prettify.css" type="text/css" rel="stylesheet">
    <link href="bootstrap/css/lang-matlab.css" type="text/css" rel="stylesheet">
  </head>
  <body onload="prettyPrint()">
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner"> <a class="btn btn-navbar" data-toggle="collapse"
          data-target=".nav-collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span>
          <span class="icon-bar"></span> </a>
        <div class="container"> <a class="brand" href="index.html">Manopt</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="index.html"><i class="icon-home"></i> Home</a></li>
              <li><a href="tutorial.html"><i class="icon-road"></i> Tutorial</a></li>
              <li><a href="downloads.html"><i class="icon-download-alt"></i>
                  Downloads</a></li>
              <li><a href="forum.html"><i class="icon-edit"></i> Forum</a></li>
              <li><a href="about.html"><i class="icon-user"></i> About</a></li>
              <li><a href="#contactmodal" data-toggle="modal"><i class="icon-envelope"></i>
                  Contact</a></li>
            </ul>
          </div>
          <!--/.nav-collapse --> </div>
      </div>
    </div>
    <!-- Contact modal Begin -->
    <div id="contactmodal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
      aria-hidden="true">
      <div class="modal-header"> <button type="button" class="close" data-dismiss="modal"
          aria-hidden="true">&#215;</button>
        <h3 id="myModalLabel">To contact us</h3>
      </div>
      <div class="modal-body">
        <p>To discuss code, it is best to use the <a href="forum.html">forum</a>.</p>
        <p>For things not suitable for the forum, e-mail us at <a href="mailto:manopttoolbox@gmail.com">manopttoolbox@gmail.com</a>.</p>
        <p>We are happy to receive feedback and bug reports or requests for more
          features, to discuss the toolbox in general as well as its
          documentation and to help you use it.</p>
        <p>We would also love to know how you use the toolbox, and if you built
          nice manifold factories, solvers or tools that could benefit others.</p>
      </div>
      <div class="modal-footer"> <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
      </div>
    </div>
    <!-- Contact modal End -->
    <div class="container">
      <div class="row">
        <div class="span12">
          <!--Body content-->
          <section id="geometry">
            <div class="page-header">
              <h1>A Riemannian geometry for the symmetric stochastic multinomial
                manifold</h1>
            </div>
            <p>The symmetric stochastic multinomial manifold $\mathcal{SP}_n$
              (the set of symmetric entry-wise positive matrices of size <span
                style="font-family: monospace;">nxn</span> with columns and rows
              summing to 1) is endowed with a Riemannian manifold structure by
              considering it as a Riemannian submanifold of the embedding
              Euclidean space $\mathbb{R}^{n\times n}$ endowed with the Fisher
              information as inner product
              $\langle\xi_\mathbf{X},\eta_\mathbf{X}\rangle_\mathbf{X} =
              \sum\limits_{i=1}^n \sum\limits_{j=1}^n
              \cfrac{(\xi_\mathbf{X})_{ij}
              (\eta_\mathbf{X})_{ij}}{\mathbf{X}_{ij}}$. The geometry of the
              symmetric stochastic multinomial manifold is available in the
              research paper [DH18].</p>
            <p>Factory call: <code>M = multinomialsymmetricfactory(n)</code>.</p>
            <p>There is also a non-symmetric version of this factory: see <code>multinomialdoublystochasticfactory</code>.</p>
            <table style="width: 100%;" class="table table-striped table-bordered">
              <thead>
                <tr>
                  <td>Name </td>
                  <td>Formula </td>
                  <td>Numerical representation</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Set</td>
                  <td>$\mathcal{SP}_n = \left\{ \mathbf{X} \in \mathbb{R}^{n
                    \times n} \big| \mathbf{X}_{ij} &gt; 0,\
                    \mathbf{X}\mathbf{1}=\mathbf{1},\ \mathbf{X}=\mathbf{X}^T
                    \right\}$</td>
                  <td>$X$ is represented as a symmetric matrix <code>X</code>
                    of size <span style="font-family: monospace;">nxn</span>
                    whose columns and rows sum to 1, i.e., <code>sum(X(:, i))=
                      1</code> for <code>i = 1:n </code> and <code>X= X'</code>.</td>
                </tr>
                <tr>
                  <td>Tangent space at $X$</td>
                  <td>$\mathcal{T}_{\mathbf{X}}\mathcal{S}\mathcal{P}_{n} =
                    \left\{\mathbf{Z} \in \mathbb{R}^{n \times n} \big|
                    \mathbf{Z}\mathbf{1}=\mathbf{0},\ \mathbf{Z}=\mathbf{Z}^T
                    \right\}$</td>
                  <td>A tangent vector $Z$ at $X$ is represented as a symetric
                    matrix <code>Z</code> of size <span style="font-family: monospace;">nxn
                      </span> such that each column and row of <code>Z</code>
                    sum to 0, i.e., <code>sum(Z(:, i))= 0</code> for <code>i =
                      1:n </code> and <code>Z= Z'</code>.</td>
                </tr>
                <tr>
                  <td>Ambient space</td>
                  <td>$\mathbb{R}^{n\times n}$</td>
                  <td>Points and vectors in the ambient space are, naturally,
                    represented as matrices of size <span style="font-family: monospace;">nxn</span>.</td>
                </tr>
              </tbody>
            </table>
          </section>
          <section id="toolset">
            <div class="page-header">
              <h1>Toolset</h1>
            </div>
            <p>The following table shows some of the nontrivial available
              functions in the structure <code>M</code>. The norm $\|\cdot\|$
              refers to the norm in the ambient space, which is the Frobenius
              norm. The <a href="tutorial.html#manifolds">tutorial page</a>
              gives more details about the functionality implemented by each
              function.</p>
            <table style="width: 100%;" class="table table-striped table-bordered">
              <thead>
                <tr>
                  <td>Name </td>
                  <td>Field usage </td>
                  <td>Formula </td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Dimension </td>
                  <td><code>M.dim() </code></td>
                  <td>$\operatorname{dim}\mathcal{M} = \frac{n(n-1)}{2}$ </td>
                </tr>
                <tr>
                  <td>Metric </td>
                  <td><code>M.inner(X, U, V) </code></td>
                  <td>$\langle U, V\rangle_X = \operatorname{trace}(U^T (V
                    \oslash X)) = \sum\limits_{i,j=1}^n \cfrac{U_{ij}
                    V_{ij}}{X_{ij}}$ </td>
                </tr>
                <tr>
                  <td>Norm </td>
                  <td><code>M.norm(X, U) </code></td>
                  <td>$\|U\|_X = \sqrt{\langle U, U \rangle_X}$</td>
                </tr>
                <tr>
                  <td>Distance </td>
                  <td><code>M.dist(X, Y) </code></td>
                  <td>$\operatorname{dist}(X, Y) = \sqrt{\sum_{i=1}^m
                    \arccos^2((X^T Y)_{ii})}$ </td>
                </tr>
                <tr>
                  <td>Typical distance </td>
                  <td><code>M.typicaldist() </code></td>
                  <td>$n*pi/2$ </td>
                </tr>
                <tr>
                  <td>Tangent space projector </td>
                  <td><code>M.proj(X, H) </code></td>
                  <td>$P_X(H)$ represents the orthogonal projection, in the
                    Fisher information inner product sens, of the ambient point
                    H onto the tangent space
                    $\mathcal{T}_{\mathbf{X}}\mathcal{S}\mathcal{P}_{n}$.</td>
                </tr>
                <tr>
                  <td>Euclidean to Riemannian gradient</td>
                  <td><nobr><code>M.egrad2rgrad(X, egrad)</code></nobr></td>
                  <td>$\operatorname{grad} f(X) = P_X(\nabla f(X) \odot X)$,
                    where <code>egrad</code> represents the Euclidean gradient
                    $\nabla f(X)$, which is a vector in the ambient space. </td>
                </tr>
                <tr>
                  <td>Euclidean to Riemannian Hessian</td>
                  <td><nobr><code>M.ehess2rhess(X, egrad, ehess, U)</code></nobr>
                  </td>
                  <td>$\operatorname{Hess} f(X)[U]$ represents the Riemannian
                    gradient, where <code>egrad</code> represents the Euclidean
                    gradient $\nabla f(X)$ and <code>ehess</code> represents
                    the Euclidean Hessian $\nabla^2 f(X)[U]$, both being vectors
                    in the ambient space.</td>
                </tr>
                <tr>
                  <td>Retraction </td>
                  <td><code>M.retr(X, U, t) </code></td>
                  <td>$\operatorname{Retr}_X(tU)$ retracts the tangent vector U
                    to the manifold, i.e., U is a doubly stochastic matrix.</td>
                </tr>
                <tr>
                  <td>Random point </td>
                  <td><code>M.rand() </code></td>
                  <td>Returns a point uniformly at random from the set of
                    symmetric stochastic matrices. </td>
                </tr>
                <tr>
                  <td>Random vector </td>
                  <td><code>M.randvec(X) </code></td>
                  <td>Returns a unit-norm tangent vector at $X$ with uniformly
                    random direction, obtained as follows: generate $H$ with
                    i.i.d. normal entries; return: $U = P_X(H) / \|P_X(H)\|$.</td>
                </tr>
                <tr>
                  <td>Vector transport </td>
                  <td><code>M.transp(X, Y, U) </code></td>
                  <td>$\operatorname{Transp}_{Y\leftarrow X}(U) = P_Y(U)$, where
                    $U$ is a tangent vector at $X$ that is transported to the
                    tangent space at $Y$. </td>
                </tr>
              </tbody>
            </table>
            <p></p>
          </section>
          <section id="differentials">
            <div class="page-header">
              <h1>Example</h1>
            </div>
            <p>Let $A\in\mathbb{R}^{n\times n}$ be a noisy version of a
              symmetric stochastic matrix. We search for the symmetric
              stochastic matrix that is closest to $A$ according to the
              Frobenius norm. We minimize the following cost function:</p>
            <p>$$f(X) = \frac{1}{2} \|X-A\|^2,$$</p>
            <p>such that $X \in \mathcal{SP}_n$. Compute the Euclidean gradient
              and Hessian of $f$:</p>
            <p>$$\nabla f(X) = X-A,$$</p>
            <p>$$\nabla^2 f(X)[U] = U.$$</p>
            <p>The Riemannian gradient and Hessian are computed automatically
              from these.</p>
            <pre class="prettyprint lang-matlab linenums">% Generate the problem data.

n = 100 ; % Size of the matrix
sigma = 1/n^2 ; % Noise standard deviation at each entry

symm = @(X) .5*(X+X'); % Inline function to make a matrix symmetric

% Generate a doubly stochastic matrix using the Sinkhorn algorithm
B = symm(doubly_stochastic(abs(randn(n, n)))) ;
% Adding noise to the matrix
B = max(B + sigma*symm(randn(n, n)),0.01) ;

% Denoising function and derivatives
cost = @(X) 0.5*norm( A-X, 'fro')^2; % Cost function
egrad = @(X) X - A;  % Euclidean Gradient
ehess = @(X, U) U; % Euclidean Hessian

% Manifold initialization
manifold = multinomialsymmetricfactory(n);
problem.M = manifold;
problem.cost = cost;
problem.egrad = egrad;
problem.ehess = ehess;

% Numerically check the differentials.
checkgradient(problem); pause;
checkhessian(problem); pause; % Since the retraction is only first-order, the slope test is valid only at critical points.<br><br>X = trustregions(problem); % Solve the problem with a local optimization algorithm
</pre></section>
          <section id="references">
            <div class="page-header">
              <h1>References</h1>
            </div>
            <p>For theory on Riemannian submanifolds, see [AMS08], section 3.6.1
              (first-order derivatives) and section 5.3.3 (second-order
              derivatives, i.e., connections).</p>
            <p>For content specifically about the symmetric stochastic
              multinomial manifold with applications, see [DH18].</p>
            <p>[AMS08] P.-A. Absil, R. Mahony and R. Sepulchre, <a target="_blank"
                href="https://press.princeton.edu/absil">Optimization Algorithms
                on Matrix Manifolds</a>, Princeton University Press, 2008.<br>
              [DH18] A. Douik and B. Hassibi, <a href="https://arxiv.org/abs/1802.02628">
                Manifold Optimization Over the Set of Doubly Stochastic
                Matrices: A Second-Order Geometry</a>, 2018.</p>
          </section>
        </div>
      </div>
    </div>
    <!-- /container --><!-- Le javascript ================================================== -->
    <script type="text/javascript" src="bootstrap/js/jquery.min.js"></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
    <script type="text/javascript" src="bootstrap/js/prettify.js"></script>
    <script type="text/javascript" src="bootstrap/js/lang-matlab.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37402854-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> </body>
</html>
