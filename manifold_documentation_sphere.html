<!DOCTYPE html>
<html lang="en">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Manopt, sphere manifold</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="favicon.ico" rel="icon" type="image/x-icon">
    <!-- Le styles -->
    <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
body {
        padding-top: 80px;
        padding-bottom: 40px;
}
      thead {
        font-weight: bold;
      }
    </style>
    <link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>    <![endif]-->
    <link href="bootstrap/css/prettify.css" type="text/css" rel="stylesheet">
    <link href="bootstrap/css/lang-matlab.css" type="text/css" rel="stylesheet">
  </head>
  <body onload="prettyPrint()">
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner"> <a class="btn btn-navbar" data-toggle="collapse"
          data-target=".nav-collapse"> <span class="icon-bar"></span> <span
            class="icon-bar"></span> <span class="icon-bar"></span> </a>
        <div class="container"> <a class="brand" href="index.html">Manopt</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="index.html"><i class="icon-home"></i> Home</a></li>
              <li><a href="tutorial.html"><i class="icon-road"></i> Tutorial</a></li>
              <li><a href="downloads.html"><i class="icon-download-alt"></i> Downloads</a></li>
            <li><a href="forum.html"><i class="icon-edit"></i> Forum</a></li>
            <li><a href="about.html"><i class="icon-user"></i> About</a></li>
            <li><a href="#contactmodal" data-toggle="modal"><i class="icon-envelope"></i> Contact</a></li>
          </ul>
        </div>
        <!--/.nav-collapse --> </div>
    </div>
  </div>
  <!-- Contact modal Begin -->
  <div id="contactmodal" class="modal hide fade" tabindex="-1" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header"> <button type="button" class="close" data-dismiss="modal"
        aria-hidden="true">&#215;</button>
      <h3 id="myModalLabel">To contact us</h3>
    </div>
    <div class="modal-body">
      <p>To discuss code, it is best to use the <a href="forum.html">forum</a>.</p>
      <p>For things not suitable for the forum, e-mail us at <a href="mailto:manopttoolbox@gmail.com">manopttoolbox@gmail.com</a>.</p>
      <p>We are happy to receive feedback and bug reports or requests for more features, to discuss the toolbox in general as well as its documentation and to help you use it.</p>
      <p>We would also love to know how you use the toolbox, and if you built nice manifold factories, solvers or tools that could benefit others.</p>
    </div>
    <div class="modal-footer"> <button class="btn" data-dismiss="modal"
        aria-hidden="true">Close</button> </div>
  </div>
  <!-- Contact modal End -->
  <div class="container">
    <div class="row">
      <div class="span12">
        <!--Body content-->
        <section id="geometry">
          <div class="page-header">
            <h1>A Riemannian geometry for the sphere</h1>
          </div>
          <p>The sphere $\mathbb{S}^{nm-1}$ (the set of unit Frobenius norm matrices of size <span
              style="font-family: monospace;">nxm</span>) is endowed with a Riemannian manifold structure by considering it as a Riemannian submanifold of the embedding Euclidean space $\mathbb{R}^{n\times m}$ endowed with the usual inner product $\langle H_1, H_2 \rangle = \operatorname{trace}(H_1^T H_2)$.</p>
          <p>Factory call: <code>M = spherefactory(n, m)</code>. By default, <code>m</code> equals 1. If you need to work with several vectors of unit norm, have a look at <a
              href="manifold_documentation_oblique.html">the oblique manifold</a>.</p>
          <table style="width: 100%;" class="table table-striped table-bordered">
            <thead>
              <tr>
                <td>Name </td>
              <td>Formula </td>
            <td>Numerical representation</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Set</td>
            <td>$\mathbb{S}^{nm-1} = \{ X \in \mathbb{R}^{n\times m} : \|X\| = 1 \}$</td>
            <td>$X$ is represented as a matrix <code>X</code> of size <span
                style="font-family: monospace;">nxm</span> with unit Frobenius norm, i.e., <code>X(:).'*X(:) = 1</code>.</td>
          </tr>
          <tr>
            <td>Tangent space at $X$</td>
            <td>$T_X \mathbb{S}^{nm-1} = \{ U \in \mathbb{R}^{n\times m} : \operatorname{trace}(X^T U) = 0 \}$</td>
            <td>A tangent vector $U$ at $X$ is represented as a matrix <code>U</code> of size <span
                style="font-family: monospace;">nxm </span>such that $\operatorname{trace}(X^T U) = 0$, i.e., <code>X(:).'*U(:) = 0</code>.</td>
          </tr>
          <tr>
            <td>Ambient space</td>
            <td>$\mathbb{R}^{n\times m}$</td>
            <td>Points and vectors in the ambient space are, naturally, represented as matrices of size <span
                style="font-family: monospace;">nxm</span>.</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="toolset">
      <div class="page-header">
        <h1>Toolset</h1>
      </div>
      <p>The following table shows some of the nontrivial available functions in the structure <code>M</code>. The norm $\|\cdot\|$ refers to the norm in the ambient space, which is the Frobenius norm. The <a
          href="tutorial.html#manifolds">tutorial page</a> gives more details about the functionality implemented by each function.</p>
      <table style="width: 100%;" class="table table-striped table-bordered">
        <thead>
          <tr>
            <td>Name </td>
          <td>Field usage </td>
        <td>Formula </td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Dimension </td>
    <td><code>M.dim() </code></td>
    <td>$\operatorname{dim}\mathcal{M} = nm-1$ </td>
</tr>
<tr>
  <td>Metric </td>
<td><code>M.inner(X, U, V) </code></td>
<td>$\langle U, V\rangle_X = \operatorname{trace}(U^T V)$ </td>
</tr>
<tr>
  <td>Norm </td>
<td><code>M.norm(X, U) </code></td>
<td>$\|U\|_X = \sqrt{\langle U, U \rangle_X}$</td>
</tr>
<tr>
  <td>Distance </td>
<td><code>M.dist(X, Y) </code></td>
<td>$\operatorname{dist}(X, Y) = \arccos(\operatorname{trace}(X^T Y))$ </td>
</tr>
<tr>
  <td>Typical distance </td>
<td><code>M.typicaldist() </code></td>
<td>$\pi$ </td>
</tr>
<tr>
  <td>Tangent space projector </td>
<td><code>M.proj(X, H) </code></td>
<td>$P_X(H) = H - \operatorname{trace}(X^T H) X$, where <code>H</code> represents a vector in the ambient space. </td>
</tr>
<tr>
  <td>Euclidean to Riemannian gradient</td>
  <td><nobr><code>M.egrad2rgrad(X, egrad)</code></nobr></td>
  <td>$\operatorname{grad} f(X) = P_X(\nabla f(X))$, where <code>egrad</code> represents the Euclidean gradient $\nabla f(X)$, which is a vector in the ambient space. </td>
</tr>
<tr>
  <td>Euclidean to Riemannian Hessian</td>
  <td><nobr><code>M.ehess2rhess(X, egrad, ehess, U)</code></nobr> </td>
<td>$\operatorname{Hess} f(X)[U] = P_X(\nabla^2 f(X)[U]) - \operatorname{trace}(X^T \nabla f(X)) U$, where <code>egrad</code> represents the Euclidean gradient $\nabla f(X)$ and <code>ehess</code> represents the Euclidean Hessian $\nabla^2 f(X)[U]$, both being vectors in the ambient space.</td>
</tr>
<tr>
  <td>Exponential map </td>
<td><code>M.exp(X, U, t) </code></td>
<td>$\operatorname{Exp}_X(tU) = \cos(\|tU\|) X + \frac{\sin(\|tU\|)}{\|U\|} U$ </td>
</tr>
<tr>
  <td>Retraction </td>
<td><code>M.retr(X, U, t) </code></td>
<td>$\operatorname{Retr}_X(tU) = \frac{X+tU}{\|X+tU\|}$ (Frobenius norm in the ambient space) </td>
</tr>
<tr>
  <td>Logarithmic map </td>
<td><code>M.log(X, Y) </code></td>
<td>$\operatorname{Log}_X(Y) = \frac{\operatorname{dist}(X, Y)}{\|P_X(Y-X)\|} P_X(Y-X)$ </td>
</tr>
<tr>
  <td>Random point </td>
<td><code>M.rand() </code></td>
<td>Returns a point uniformly at random w.r.t. the natural measure as follows: generate $Y$ with i.i.d. normal entries; return $Y/\|Y\|$. </td>
</tr>
<tr>
  <td>Random vector </td>
<td><code>M.randvec(X) </code></td>
<td>Returns a unit-norm tangent vector at $X$ with uniformly random direction, obtained as follows: generate $H$ with i.i.d. normal entries; return $P_X(H)/\|P_X(H)\|$. </td>
</tr>
<tr>
  <td>Vector transport </td>
<td><code>M.transp(X, Y, U) </code></td>
<td>$\operatorname{Transp}_{Y\leftarrow X}(U) = P_Y(U)$, where $U$ is a tangent vector at $X$ that is transported to the tangent space at $Y$. </td>
</tr>
<tr>
  <td>Pair mean </td>
<td><code>M.pairmean(X, Y) </code></td>
<td>$\operatorname{mean}(X, Y) = \frac{X+Y}{\|X+Y\|}$ </td>
</tr>
</tbody>
</table>
<p></p>
</section>
<section id="differentials">
  <div class="page-header">
    <h1>Example</h1>
  </div>
  <p>This example continues the example from the <a href="tutorial.html#firstexample">tutorial page</a>. Let $A\in\mathbb{R}^{n\times n}$ be a symmetric matrix. We minimize the following cost function:</p>
  <p>$$f(x) = -x^T Ax,$$</p>
  <p>such that $x^T x = 1$, that is, such that $x$ belongs to the sphere $\mathbb{S}^{n-1}$. Compute the Euclidean gradient and Hessian of $f$:</p>
  <p>$$\nabla f(x) = -2Ax,$$</p>
  <p>$$\nabla^2 f(x)[u] = -2Au.$$</p>
  <p>The Riemannian gradient and Hessian are obtained by applying the <code>M.egrad2rgrad</code> and <code>M.ehess2rhess</code> operators:</p>
  <p>$$\operatorname{grad} f(x) = (I-xx^T) \nabla f(x),$$</p>
  <p>$$\operatorname{Hess} f(x)[u] = (I-xx^T)\nabla^2 f(x)[u] - (x^T \nabla f(x)) u.$$</p>
  <p>Notice that there is no need to compute these explicitly: it suffices to write code for the Euclidean quantities and to apply the conversion tools on them to obtain the Riemannian quantities, as in the following code:</p>
  <pre class="prettyprint lang-matlab linenums">% Generate the problem data.
n = 1000;
A = randn(n);
A = .5*(A+A');

% Create the problem structure.
manifold = spherefactory(n);
problem.M = manifold;

% Define the problem cost function and its derivatives.<br>problem.cost = @(x) -x'*(A*x);<br>egrad = @(x) -2*A*x;<br>ehess = @(x, u) -2*A*u;
problem.grad = @(x) manifold.egrad2rgrad(x, egrad(x));<br>problem.hess = @(x, u) manifold.ehess2rhess(x, egrad(x), ehess(x, u), u);<br><br>% Numerically check the differentials.<br>checkgradient(problem); pause;<br>checkhessian(problem); pause;<br><br>% Solve<br>x = trustregions(problem);</pre>
  <p>Of course, this is not efficient since the computation of $Ax$ should be reused when computing $f(x)$ and $\nabla f(x)$, just like$\nabla f(x)$ should be reused to compute $\nabla^2 f(x)[u]$. See the <a
      href="tutorial.html#costdescription">various ways of describing the cost function</a> for better alternatives.</p>
</section>
<section id="references">
  <div class="page-header">
    <h1>References</h1>
  </div>
  <p>For theory on Riemannian submanifolds, see [AMS08], section 3.6.1 (first-order derivatives) and section 5.3.3 (second-order derivatives, i.e., connections).</p>
  <p>For content specifically about the sphere, see [AMS08] and look up examples 3.5.1 (tangent space), 3.6.1 (metric, projector), 4.1.1 (retraction), 5.3.1 (connection), 5.4.1 (exponential map, i.e., geodesics) and 8.1.1 (parallel translation, not implemented), 8.1.4 and 8.1.7 (vector transport).</p>
  <p>[AMS08] P.-A. Absil, R. Mahony and R. Sepulchre, <a target="_blank"
      href="https://press.princeton.edu/absil">Optimization Algorithms on Matrix Manifolds</a>, Princeton University Press, 2008.</p>
</section>
<section id="examples">
  <div class="page-header">
    <h1>List of examples</h1>
  </div>
  <p>The first example on the <a href="tutorial.html">tutorial page</a> is an example on the sphere. Section 6.4.1 in [AMS08] also gives an example of second-order optimization on the sphere.</p>
  <p>We are still working on building a collection of examples for Manopt. The relevant ones will be referenced here when the time comes.</p>
</section>
</div>
</div>
</div>
<!-- /container --><!-- Le javascript ================================================== -->
<script type="text/javascript" src="bootstrap/js/jquery.min.js"></script>
<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
<script type="text/javascript" src="bootstrap/js/prettify.js"></script>
<script type="text/javascript" src="bootstrap/js/lang-matlab.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37402854-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
